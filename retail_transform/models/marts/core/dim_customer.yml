version: 2

models:
  - name: dim_customer
    description: >
      Customer dimension table containing one record per customer with
      aggregated lifetime metrics and behavioral segmentation.
      
      **Business Use Cases:**
      - Customer segmentation and targeting
      - Lifetime value analysis
      - Churn prediction
      - Marketing campaign personalization
      
      **Update Frequency:** Daily (full refresh)
      **SCD Type:** Type 1 (current values only)
    
    columns:
      - name: customer_key
        description: "Surrogate key (hash of customer_id)"
        tests:
          - unique
          - not_null
      
      - name: customer_id
        description: "Business key (natural customer identifier)"
        tests:
          - unique
          - not_null
      
      - name: total_lifetime_value
        description: "Total revenue generated by customer (excludes returns)"
        tests:
          - not_null
          - dbt_utils.accepted_range:
              min_value: 0
      
      - name: frequency_segment
        description: "Purchase frequency classification"
        tests:
          - accepted_values:
              values: ['One-time', 'Occasional', 'Regular', 'Frequent']
      
      - name: value_segment
        description: "Customer value classification based on LTV"
        tests:
          - accepted_values:
              values: ['Low-Value', 'Medium-Value', 'High-Value', 'VIP']
      
      - name: recency_segment
        description: "Activity recency classification"
        tests:
          - accepted_values:
              values: ['Active', 'Lapsing', 'Dormant', 'Churned']